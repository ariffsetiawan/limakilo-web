<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Basic Page Needs
    ================================================== -->
    <meta charset="utf-8">
    <!--[if IE]><meta http-equiv="x-ua-compatible" content="IE=9" /><![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pre Order - Limakilo</title>
    <meta name="description" content="aplikasi yang membantu petani menjual komoditi (saat ini baru bawang) langsung ke semua orang dengan harga yang lebih kompetitif.">
    <meta name="keywords" content="limakilo, bawang, komoditi, sembako">
    <meta name="author" content="limakilo.id">
    
    <!-- Favicons
    ================================================== -->
    <link rel="shortcut icon" href="img/limakilo.png" type="image/x-icon">
    <link rel="apple-touch-icon" href="img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="img/apple-touch-icon-114x114.png">

    <!-- Bootstrap -->
    <link rel="stylesheet" type="text/css"  href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="fonts/font-awesome/css/font-awesome.css">

    <!-- Slider
    ================================================== -->
    <link href="css/owl.carousel.css" rel="stylesheet" media="screen">
    <link href="css/owl.theme.css" rel="stylesheet" media="screen">

    <!-- Stylesheet
    ================================================== -->
    <link rel="stylesheet" type="text/css"  href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/responsive.css">

    <!-- <link href='http://fonts.googleapis.com/css?family=Lato:100,300,400,700,900,100italic,300italic,400italic,700italic,900italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,700,300,600,800,400' rel='stylesheet' type='text/css'>
 -->
    <script type="text/javascript" src="js/modernizr.custom.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-21214418-15', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body>

  <!-- Navigation
    ==========================================-->
    <nav id="tf-menu" class="navbar navbar-default navbar-inverse navbar-fixed-top" style="background : url('img/04.jpg')">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="">Limakilo</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li class="active"><a href="/preorder_user">Pre Order</a></li>
            <li><a href="/order_user">Order Saya</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><img src=<%= user.photo %> height="24px"> <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li>
                
                    <a href="#"><b><%= user.username %></b></a>
                  
                </li>
                <li role="separator" class="divider"></li>
                <li><a href="/logout">Logout</a></li>
              </ul>
            </li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>

    
    <div id="" class="text-center" style="margin-top:80px;">
        <div class="container">

        <div class="row">
          <div class="col-md-12">
            <div class="page-header" style="background : url('img/bawang.jpg') bottom;min-height:150px;">
  
              <h2 style="padding-top:70px;color:#ffffff;"><%=title%></h2>
              
              
            </div>
            
            <div class="panel" style="min-height:300px;">


                <div class="row text-center">

                <div class="alert alert-info col-sm-6 col-sm-offset-3">Mohon maaf, saat ini baru melayani pemesanan ke daerah Jakarta, Depok, Tangerang, Bekasi dan Bandung dengan ongkos kirim gratis untuk pembelian >= 5 kg.</div>

                <div id="order-message" class="col-sm-6 col-sm-offset-3"></div>
                
                  <div class="col-md-4 col-md-offset-4">
                      <h3>Data Pemesanan</h3>
                      <hr>
                      <form method="post" id="form-order">

                          <div class="form-group">
                              <label>Produk</label><br>
                              <select name="stock_id" id="stock_id" class="form-control" required>
                                 <% if(data.length){ 
                                      
                                    for(var i = 0;i < data.length;i++) { %>
                                    <option value="<%=data[i].sto_id%>"><%=data[i].sto_name%> (per kilo : Rp <%=numeral(data[i].sto_price).format('0,0')%>)</option>
                                    <% }

                                  } %>
                              </select>
                          </div>

                          <div class="form-group">
                              <label>Jumlah Paket</label><br>
                              <select name="order_quantity" id="order_quantity" class="form-control" required>
                                 <% for(var i = 1;i <= 100;i++) { %>
                                    <option value="<%=i%>"><%=i%></option>
                                    <% } %>
                              </select>
                          </div>
                          
                          <h3>Data Pengguna dan Pengiriman</h3>
                          <hr>

                          <div class="form-group">
                              <label>Email</label><br>
                              <input type="email" class="form-control" name="email" id="email" placeholder="Email" value="<%= user.email %>" required>
                          </div>
                          <div class="form-group">
                              
                              <input type="hidden" name="user_id" value="<%= user.id %>">
                              <input type="hidden" name="web" value="1">
                              <label>Nama Depan</label><br>
                              <input type="text" class="form-control" name="first_name" id="first_name" placeholder="Nama Depan" value="<%=user.firstname%>" required>
                              
                          </div>
                          <div class="form-group">

                              <label>Nama Belakang</label><br>
                              <input type="text" class="form-control" name="last_name" id="last_name" placeholder="Nama Belakang" value="<%=user.lastname%>" required>
                              
                          </div>
                          <div class="form-group">

                              <label>No HP</label><br>
                              <input type="text" class="form-control" name="order_phone" id="order_phone" placeholder="No HP" value="<%=user.phone%>" required>
                              
                          </div>
                          <div class="form-group">
                              <label>Alamat Pengiriman</label><br>
                              <textarea class="form-control" name="order_address" id="order_address" placeholder="Alamat Pengiriman" required><%=user.address%></textarea>
                          </div>

                          <div class="form-group">
                              <label>Kota</label><br>
                              <select name="order_city" id="order_city" class="form-control" required>
                                 
                                  <option value="Jakarta" <% if(user.city=="Jakarta") { %> selected="selected" <% } %>>Jakarta</option>
                                  <option value="Depok" <% if(user.city=="Depok") { %> selected="selected" <% } %>>Depok</option>
                                  <option value="Tangerang" <% if(user.city=="Tangerang") { %> selected="selected" <% } %>>Tangerang</option>
                                  <option value="Bekasi" <% if(user.city=="Bekasi") { %> selected="selected" <% } %>>Bekasi</option>
                                  <option value="Bandung" <% if(user.city=="Bandung") { %> selected="selected" <% } %>>Bandung</option>
                                    
                              </select>
                          </div>

                          <input type="submit" value="Pesan" class="btn btn-primary btn-lg">
                          <hr>
                      </form>

                      

                  </div>

              
            </div> <!-- /.row -->

            
                    
            </div>
              
            
          </div>
        </div>
        </div>
    </div>

   
   
    <nav id="footer">
        <div class="container">
            <div class="pull-left fnav">
                <p>&copy; 2015 Limakilo. All rights reserved.</p>
            </div>
            <div class="pull-right fnav">
                <ul class="footer-social">
                    <li><a href="https://instagram.com/limakilo.id/" target="_blank"><i class="fa fa-instagram"></i></a></li>
                    <li><a href="https://twitter.com/limakilo_id" target="_blank"><i class="fa fa-twitter"></i></a></li>
                </ul>
            </div>
        </div>
    </nav>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery.1.11.1.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <script type="text/javascript" src="js/SmoothScroll.js"></script>
    <script type="text/javascript" src="js/jquery.isotope.js"></script>

    <script src="js/owl.carousel.js"></script>

    <!-- Javascripts
    ================================================== -->
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript" src="js/jquery.validate.min.js"></script>

    <script type="text/javascript">

    $('#form-order').validate({


        submitHandler: function(form) {
            subscribe();
        }
    });

    function subscribe(){
           
           $.ajax({
            headers:{authentification:'<%= user.access_token %>'},
            url:"/orders",
            type:"post",
            data:$("#form-order").serialize(),
            success:function(res){
                
                

                if (res.Message=="Success") {
                    //$('#order-message').html('<div class="alert alert-success"> wew '+res.data[0].order_id+'</div>');

                    window.location.href = '/preorder_success/'+res.data[0].order_id;
                } else{
                    $('#order-message').html('<div class="alert alert-danger">'+res.Message+'</div>');
                }
                // alert(res.Message);

                
                
                return false;
            },
            error:function(xhr, status, error){
                
                console.log(xhr.responseText);
                var err = '';
                $.each(JSON.parse(xhr.responseText) , function(i, item) {
                   
                     err +='<li>'+item.msg+'</li>';
                });
                $(".err-area").show();    
                $(".err-area").html(err);    
                return false;
            }
            
           });
        }
    </script>
    <script src="https://cdn.supportkit.io/supportkit.min.js"></script>
    <script>
        SupportKit.init({appToken: 'e37bwzthf9w5jmmrab64m8jve'});
    </script>
  </body>
</html>